<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="3" MadCap:lastHeight="72" MadCap:lastWidth="697" MadCap:disableMasterStylesheet="true" MadCap:tocPath="Routines (alphabetical)|Routines: L" MadCap:medium="non-print" MadCap:InPreviewMode="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" MadCap:PathToHelpSystem="../../../" MadCap:HelpSystemFileName="idl.xml" MadCap:SearchType="Stem">
    <!-- saved from url=(0014)about:internet -->
    <head><title>LSODE </title>
        <link href="../../SkinSupport/MadCap.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/Table_Format.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/Version_Table.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/IDL_style.css" rel="stylesheet" />
        <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink" style="display: none;"><a href="../../../idl_CSH.html#Reference Material/L/LSODE.html" style="">Open topic with navigation</a>
        </p>
        <div class="MCBreadcrumbsBox"><a class="MCBreadcrumbsLink" href="../../images/ref_part1.html">Routines (alphabetical)</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="L64INDGEN.html">Routines: L</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">LSODE</span>
        </div>
        <h1 class="Routine"><a name="L_826528365_916288"></a><a name="L_826528365_26443"></a>LSODE </h1>
        <p class="CellBody" MadCap:conditions="Reference Material.Online_Help_Only">
            <MadCap:conditionalText MadCap:conditions="Reference Material.Online_Help_Only"><a class="MCXref" href="#L_826528365_859118">Syntax</a> | <a class="MCXref" href="#L_826528365_963173">Return Value</a> | <a class="MCXref" href="#L_826528365_859120">Arguments</a> | <a class="MCXref" href="#L_826528365_904981">Keywords</a> | <a class="MCXref" href="#L_826528365_859140">Examples</a> | <a class="MCXref" href="#L_826528365_881529">See Also</a> | <a class="MCXref" href="#L_826528365_952439">Version History</a></MadCap:conditionalText>
        </p>
        <p>The <a name="kanchor1715"></a>LSODE function uses adaptive numerical methods to advance a solution to a system of ordinary differential equations<a name="kanchor1716"></a> one time-step H, given values for the variables <i>Y</i> and <i>X</i>.</p>
        <h2><a name="L_826528365_859118"></a><a name="L_826528365_859118_PageTOC_LSODE_"></a>Syntax</h2>
        <p class="Syntax"><i>Result</i> = LSODE( <i>Y</i>,<i> X</i>,<i> H</i>,<i> Derivs</i>[,&#160;<i>Status</i>] [,&#160;<a class="MCXref" href="#L_826528365_904984">ATOL</a>=<i>value</i>] [,&#160;/<a class="MCXref" href="#L_826528365_1014877">QUIET</a>] [,&#160;<a class="MCXref" href="#L_826528365_905036">RTOL</a>=<i>value</i>] )</p>
        <h2><a name="L_826528365_963173"></a><a name="L_826528365_92021"></a>Return Value</h2>
        <p>Returns the solution in a vector with the same number of elements as Y.</p>
        <h2><a name="L_826528365_859120"></a><a name="L_826528365_859120_PageTOC_LSODE_"></a>Arguments</h2>
        <h3 class="Argument">Y</h3>
        <p>A vector of values for Y at X</p>
        <h3 class="Argument">X</h3>
        <p>A scalar value for the initial condition.</p>
        <h3 class="Argument">H</h3>
        <p>A scalar value giving interval length or step size.</p>
        <h3 class="Argument">Derivs</h3>
        <p>A scalar string specifying the name of a user-supplied IDL function that calculates the values of the derivatives <i>Dydx</i> at X. This function must accept two arguments: A scalar floating value <i>X</i>, and an <i>n</i>-element vector <i>Y</i>. It must return an <i>n</i>-element vector result.</p>
        <p>For example, suppose the values of the derivatives are defined by the following relations:</p>
        <p class="Indent1"><i>dy</i><sub>0 </sub>/ <i>dx</i> = –0.5<i>y</i><sub>0,</sub>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<i>dy</i><sub>1</sub> / <i>dx</i> = 4.0 – 0.3<i>y</i><sub>1</sub> – 0.1<i>y</i><sub>0</sub></p>
        <p>We can write a function called <span class="Courier">differential</span> to express these relationships in the IDL language:</p>
        <p class="Code">FUNCTION differential, X, Y</p>
        <p class="Code">&#160;&#160;&#160;RETURN, [-0.5 * Y[0], 4.0 - 0.3 * Y[1] - 0.1 * Y[0]]</p>
        <p class="Code">END</p>
        <h3 class="Argument">Status</h3>
        <p>An index used for input and output to specify the state of the calculation. This argument contains a positive value if the function was successfully completed. Negative values indicate different errors. <MadCap:conditionalText MadCap:conditions="Reference Material.Online_Help_Only" /></p>
        <p>&#160;</p>
        <table style="width: 500px;caption-side: bottom;mc-table-style: url('../../Resources/TableStyles/Table_Format.css');" class="TableStyle_Table_Format" cellspacing="0">
            <col width="96px" />
            <col width="404px" />
            <thead>
                <tr>
                    <td class="TableStyle_Table_Format_Head_0_0_RowSep_ColSep">
                        <p class="CellHeading">Input Value</p>
                    </td>
                    <td class="TableStyle_Table_Format_Head_0_0_RowSep_ColEnd">
                        <p class="CellHeading">Description</p>
                    </td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColSep">
                        <p class="CellCentered">1</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColEnd">
                        <p class="CellBody"> This is the first call for the problem; initializations will occur. This is the default value.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColSep">
                        <p class="CellCentered">2</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColEnd">
                        <p class="CellBody">This is not the first call. The calculation is to continue normally.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_0_0_RowEnd_ColSep">
                        <p class="CellCentered">3</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowEnd_ColEnd">
                        <p class="CellBody"> This is not the first call. The calculation is to continue normally, but with a change in input parameters.</p>
                    </td>
                </tr>
            </tbody>
            <caption valign="bottom" style="padding-bottom: 12pt;">
                <p class="TableTitle"><span class="_Override" style="font-family: Helvetica;line-height: 13pt;">Input Values for Status</span>
                </p>
            </caption>
        </table>
        <p class="Note" MadCap:autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>A preliminary call with <span class="Courier">tout = t</span> is not counted as a first call here, as no initialization or checking of input is done. (Such a call is sometimes useful for the purpose of outputting the initial condition <i>s</i>.) Thus, the first call for which tout ≠ t requires <span class="Courier">STATUS = 1</span> on input.</p>
        <p class="TableAnchor">&#160;</p>
        <table style="width: 502px;caption-side: bottom;mc-table-style: url('../../Resources/TableStyles/Table_Format.css');" class="TableStyle_Table_Format" cellspacing="0">
            <col width="93px" />
            <col width="409px" />
            <thead>
                <tr>
                    <td class="TableStyle_Table_Format_Head_0_0_RowSep_ColSep">
                        <p class="CellHeading">Output Value</p>
                    </td>
                    <td class="TableStyle_Table_Format_Head_0_0_RowSep_ColEnd">
                        <p class="CellHeading">Description</p>
                    </td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColSep">
                        <p class="CellCentered">&#160;1</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColEnd">
                        <p class="CellBody"> Nothing occurred. (However, an internal counter was set to detect and prevent repeated calls of this type.)</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColSep">
                        <p class="CellCentered">&#160;2</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColEnd">
                        <p class="CellBody">The integration was performed successfully, and no roots were found.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColSep">
                        <p class="CellCentered">&#160;3</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColEnd">
                        <p class="CellBody">The integration was successful, and one or more roots were found.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColSep">
                        <p class="CellCentered">-1</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColEnd">
                        <p class="CellBody">An excessive amount of work was done on this call, but the integration was otherwise successful. To continue, reset STATUS to a value greater than1 and begin again (the excess work step counter will be reset to 0).</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColSep">
                        <p class="CellCentered">-2 </p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColEnd">
                        <p class="CellBody">The precision of the machine being used is insufficient for the requested amount of accuracy. Integration was successful. To continue, the tolerance parameters must be reset, and STATUS must be set to 3. (If this condition is detected before taking any steps, then an illegal input return (STATUS = -3) occurs instead.)</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColSep">
                        <p class="CellCentered">-3 </p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColEnd">
                        <p class="CellBody">Illegal input was detected, before processing any integration steps. If the solver detects an infinite loop of calls to the solver with illegal input, it will cause the run to stop.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColSep">
                        <p class="CellCentered">-4 </p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColEnd">
                        <p class="CellBody">There were repeated error test failures on one attempted step, before completing the requested task, but the integration was successful. The problem may have a singularity, or the input may be inappropriate.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColSep">
                        <p class="CellCentered">-5 </p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColEnd">
                        <p class="CellBody">There were repeated convergence test failures on one attempted step, before completing the requested task, but the integration was successful. This may be caused by an inaccurate jacobian matrix, if one is being used.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_0_0_RowEnd_ColSep">
                        <p class="CellCentered">-6 </p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowEnd_ColEnd">
                        <p class="CellBody">ewt(<i>i</i>) became zero for some <i>i</i> during the integration. Pure relative error control was requested on a variable which has now vanished. Integration was successful.</p>
                    </td>
                </tr>
            </tbody>
            <caption valign="bottom" style="padding-bottom: 12pt;">
                <p class="TableTitle">Output Values for Status</p>
            </caption>
        </table>
        <p class="Note" MadCap:autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>Since the normal output value of STATUS is 2, it does not need to be reset for normal continuation. Also, since a negative input value of STATUS will be regarded as illegal, a negative output value requires the user to change it, and possibly other inputs, before calling the solver again.</p>
        <h2><a name="L_826528365_904981"></a><a name="L_826528365_904981_PageTOC_LSODE_"></a>Keywords</h2>
        <h3 class="Keyword"><a name="L_826528365_904984"></a><a name="L_826528365_904984_Keywords_LSODE__"></a>ATOL</h3>
        <p>A scalar or array value that specifies the absolute tolerance. The default value is 1.0e-7. Use ATOL&#160;=&#160;0.0 (or ATOL[<i>i</i>]&#160;=&#160;0.0) for pure relative error control, and use RTOL&#160;=&#160;0.0 for pure absolute error control. For an explanation of how to use ATOL and RTOL together, see RTOL below.</p>
        <h3 class="Keyword"><a name="L_826528365_1014877"></a><a name="L_826528365_1014877_Keywords_LSODE__"></a>QUIET</h3>
        <p>Set this keyword to suppress warning messages. By default, warning messages will be output to the screen.</p>
        <h3 class="Keyword"><a name="L_826528365_905036"></a><a name="L_826528365_905036_Keywords_LSODE__"></a>RTOL</h3>
        <p>A scalar value that specifies the relative tolerance. The default value is 1.0e-7. Use RTOL&#160;=&#160;0.0 for pure absolute error control, and use ATOL&#160;=&#160;0.0 (or ATOL[<i>i</i>]&#160;=&#160;0.0) for pure relative error control. </p>
        <p>The estimated local error in the Y[<i>i</i>] argument will be controlled to be less than</p>
        <p class="Code">ewt[i] = RTOL*abs(Y[i]) + ATOL &#160;&#160;&#160;; If ATOL is a scalar.</p>
        <p class="Code">ewt[i] = RTOL*abs(Y[i]) + ATOL[i] ; If ATOL is an array.</p>
        <p>Thus, the local error test passes if, in each component, either the absolute error is less than ATOL (or ATOL[<i>i</i>]), or if the relative error is less than RTOL.</p>
        <p class="Warning" MadCap:autonum="&lt;b&gt;Warning: &lt;/b&gt;"><span class="autonumber"><span><b>Warning: </b></span></span>Actual, or global, errors might exceed these local tolerances, so choose values for ATOL and RTOL conservatively.</p>
        <h2><a name="L_826528365_859140"></a><a name="L_826528365_859140_PageTOC_LSODE_"></a>Examples</h2>
        <p>To integrate the example system of differential equations for one time step, H:</p>
        <p class="IDLCode">FUNCTION differential, X, Y<br />&#160;&#160;&#160;RETURN, [-0.5 * Y[0], 4.0 - 0.3 * Y[1] - 0.1 * Y[0]]<br />END<br /><br /><br />PRO LSODETEST<br /><br />&#160;&#160;&#160;; Define the step size:<br />&#160;&#160;&#160;H = 0.5<br /><br />&#160;&#160;&#160;; Define an initial X value:<br />&#160;&#160;&#160;X = 0.0<br /><br />&#160;&#160;&#160;; Define initial Y values:<br />&#160;&#160;&#160;Y = [4.0, 6.0]<br /><br />&#160;&#160;&#160;; Integrate over the interval (0,&#160;0.5):<br />&#160;&#160;&#160;result = LSODE(Y, X, H, 'differential')<br /><br />&#160;&#160;&#160;; Print the result:<br />&#160;&#160;&#160;PRINT, result<br /><br />END<br /><br />LSODETEST</p>
        <p>IDL prints:</p>
        <p class="Code">3.11523&#160;&#160;&#160;&#160;&#160;6.85767</p>
        <p>This is the exact solution vector to 5-decimal precision.</p>
        <h2><a name="L_826528365_881529"></a><a name="L_826528365_881529_PageTOC_LSODE_"></a>See Also</h2>
        <p><a class="MCXref" href="../D/DERIV.html#D_843829869_1032874">DERIV </a>, <a class="MCXref" href="../D/DERIVSIG.html#D_843829869_757924">DERIVSIG </a>, <a class="MCXref" href="../R/RK4.html#R_822202989_51742">RK4 </a></p>
        <h2><a name="L_826528365_881785_PageTOC_LSODE_"></a>References</h2>
        <table class="AutoNumber_p_Bullet" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 16px;" />
            <col style="width: 24px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Bullet" valign="top"><span>1. </span>
                </td>
                <td class="AutoNumber_p_Bullet" MadCap:autonum="1. " valign="top">Alan C. Hindmarsh, ODEPACK, A Systematized Collection of ODE Solvers, in Scientific Computing, R. S. Stepleman et al. (eds.), North-Holland, Amsterdam, 1983, pp. 55-64. </td>
            </tr>
        </table>
        <table class="AutoNumber_p_Bullet" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 16px;" />
            <col style="width: 24px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Bullet" valign="top"><span>2. </span>
                </td>
                <td class="AutoNumber_p_Bullet" MadCap:autonum="2. " valign="top">Linda R. Petzold, Automatic Selection of Methods for Solving Stiff and Nonstiff Systems of Ordinary Differential Equations, SIAM J. SCI. STAT. COMPUT. 4 (1983), pp. 136-148. </td>
            </tr>
        </table>
        <table class="AutoNumber_p_Bullet" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 16px;" />
            <col style="width: 24px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Bullet" valign="top"><span>3. </span>
                </td>
                <td class="AutoNumber_p_Bullet" MadCap:autonum="3. " valign="top">Kathie L. Hiebert and Lawrence F. Shampine, Implicitly Defined Output Points for Solutions of ODE’s, Sandia Report SAND80-0180, February, 1980.</td>
            </tr>
        </table>
        <h2><a name="L_826528365_952439"></a><a name="L_826528365_952439_PageTOC_LSODE_"></a>Version History</h2>
        <p class="TableAnchor">&#160;</p>
        <table class="TableStyle_Version_Table" style="width: 499px;caption-side: top;mc-table-style: url('../../Resources/TableStyles/Version_Table.css');" cellspacing="0">
            <col width="91px" />
            <col width="408px" />
            <tbody>
                <tr>
                    <td class="TableStyle_Version_Table_Body_0_0_ColSep">
                        <p class="CellBody">5.1</p>
                    </td>
                    <td class="TableStyle_Version_Table_Body_0_0_ColEnd">
                        <p class="CellBody">Introduced</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Version_Table_Body_0_0_RowEnd_ColSep">
                        <p class="CellBody">6.1</p>
                    </td>
                    <td class="TableStyle_Version_Table_Body_0_0_RowEnd_ColEnd">
                        <p class="CellBody">Added QUIET keyword</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js">
        </script>
    </body>
</html>