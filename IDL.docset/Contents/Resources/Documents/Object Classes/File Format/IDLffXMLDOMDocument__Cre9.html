<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="3" MadCap:lastHeight="72" MadCap:lastWidth="697" MadCap:disableMasterStylesheet="true" MadCap:tocPath="IDL Programming|Objects|File Format Object Classes|IDLffXMLDOMDocument" MadCap:medium="non-print" MadCap:InPreviewMode="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" MadCap:PathToHelpSystem="../../../" MadCap:HelpSystemFileName="idl.xml" MadCap:SearchType="Stem">
    <!-- saved from url=(0014)about:internet -->
    <head><title>IDLffXMLDOMDocument::CreateTreeWalker</title>
        <link href="../../SkinSupport/MadCap.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/Table_Format.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/Version_Table.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/IDL_style.css" rel="stylesheet" />
        <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink" style="display: none;"><a href="../../../idl_CSH.html#Object Classes/File Format/IDLffXMLDOMDocument__Cre9.html" style="">Open topic with navigation</a>
        </p>
        <div class="MCBreadcrumbsBox"><a class="MCBreadcrumbsLink" href="../../IDL Programming.html">IDL Programming</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../ref_part2.html">Objects</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="objects_ff.html">File Format Object Classes</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="IDLffXMLDOMDocument.html">IDLffXMLDOMDocument</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">IDLffXMLDOMDocument::CreateTreeWalker</span>
        </div>
        <h1 class="ObjMethod"><a name="objects_ff_3755668711_1263707"></a><a name="objects_ff_3755668711_81129"></a>IDLffXMLDOMDocument::CreateTreeWalker</h1>
        <p>The IDLffXMLDOMDocument::<a name="kanchor3909"></a>CreateTreeWalker function method is used to create an instance of an <a class="MCXref" href="IDLffXMLDOMTreeWalker.html#objects_ff_3755668711_1264264">IDLffXMLDOMTreeWalker</a> object. This function returns an object reference to that instance.</p>
        <p>Please note the following exceptions in tree-walking:</p>
        <table class="AutoNumber_p_Bullet" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 16px;" />
            <col style="width: 24px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Bullet" valign="top"><span>• </span>
                </td>
                <td class="AutoNumber_p_Bullet" MadCap:autonum="• " valign="top">Attributes are never children of DOM nodes, so they are not visited by the tree walker. Showing attributes is only meaningful when the walker root node is an attribute.</td>
            </tr>
        </table>
        <table class="AutoNumber_p_Bullet" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 16px;" />
            <col style="width: 24px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Bullet" valign="top"><span>• </span>
                </td>
                <td class="AutoNumber_p_Bullet" MadCap:autonum="• " valign="top">Entities are not part of the DOM tree, so they are not visited by the tree walker. Showing entities is only meaningful when the walker root node is an entity.</td>
            </tr>
        </table>
        <table class="AutoNumber_p_Bullet" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 16px;" />
            <col style="width: 24px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Bullet" valign="top"><span>• </span>
                </td>
                <td class="AutoNumber_p_Bullet" MadCap:autonum="• " valign="top">Notations are not part of the DOM tree, so they are not visited by the tree walker. Showing notations is only meaningful when the walker root node is a notation.</td>
            </tr>
        </table>
        <h2>Syntax</h2>
        <p class="Syntax"><span class="_Override" style="font-style: italic;">Result</span> = <span class="_Override" style="font-style: italic;">Obj</span>-&gt;[<a class="MCXref" href="IDLffXMLDOMDocument.html#objects_ff_3755668711_1104965">IDLffXMLDOMDocument</a>::]CreateTreeWalker( <span class="_Override" style="font-style: italic;">RootNode</span><br />[,&#160;<a class="MCXref" href="#objects_ff_3755668711_1272710">FILTER_NAME</a>=<span class="_Override" style="font-style: italic;">string</span>] [,&#160;<a class="MCXref" href="#objects_ff_3755668711_1272762">FILTER_USERDATA</a>=<span class="_Override" style="font-style: italic;">variable</span>] [,&#160;<a class="MCXref" href="#objects_ff_3755668711_1272769">WHAT_TO_SHOW</a>=<span class="_Override" style="font-style: italic;">value</span>] ) </p>
        <h2>Arguments</h2>
        <h3 class="Argument">RootNode</h3>
        <p>An object reference to an object that is a subclass of <a class="MCXref" href="IDLffXMLDOMNode.html#objects_ff_3755668711_1105014">IDLffXMLDOMNode</a> that refers to a node in the DOM tree. The tree walkers's current position is set at this node. If the object reference is NULL, the walker’s current position is set to the document node.</p>
        <h2>Keywords</h2>
        <h3 class="Keyword"><a name="objects_ff_3755668711_1272710"></a><a name="objects_ff_3755668711_72508"></a>FILTER_NAME</h3>
        <p>Set this keyword to a scalar string containing the name of an IDL function that is called each time the tree walker is about to visit a node. The purpose of this function is to allow the walker to ask the IDL application if it should visit a particular node, and hence return it in response to a call to one of the tree walker’s navigation methods (e.g., <a class="MCXref" href="IDLffXMLDOMTreeWalker__N.html#objects_ff_3755668711_1272320">IDLffXMLDOMTreeWalker::NextNode</a>). The code in this function should analyze the incoming node and then return a value that instructs the walker to accept or reject the node.</p>
        <p>If this keyword is not specified, the tree walker visits every node.</p>
        <p>The various tree-walker movement methods return nodes that are accepted by the filter function. The movement methods do not return nodes that are rejected or skipped by the filter function. The walker does not consider nodes that are children of a rejected node, but does consider children of nodes that are skipped.</p>
        <p>The tree walker calls the filter function for the given node after making determinations with respect to the <a class="MCXref" href="#objects_ff_3755668711_1272769">WHAT_TO_SHOW</a> setting. However, unlike the node iterator, the walker still calls the filter function for nodes not meeting the <a class="MCXref" href="#objects_ff_3755668711_1272769">WHAT_TO_SHOW</a> criteria. This is required so that the filter function can direct the walker to either REJECT or SKIP a node whose type is not in the <a class="MCXref" href="#objects_ff_3755668711_1272769">WHAT_TO_SHOW</a> list. If the filter function returns ACCEPT for a node not meeting the <a class="MCXref" href="#objects_ff_3755668711_1272769">WHAT_TO_SHOW</a> criteria, the walker SKIPs the node. That is, a filter function cannot override the rejection of a node because of the <a class="MCXref" href="#objects_ff_3755668711_1272769">WHAT_TO_SHOW</a> setting; it can only direct the walker to REJECT or SKIP such a node.</p>
        <p>The filter function specified by FILTER_NAME must have the following parameters:</p>
        <table class="AutoNumber_p_Bullet" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 16px;" />
            <col style="width: 24px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Bullet" valign="top"><span>• </span>
                </td>
                <td class="AutoNumber_p_Bullet" MadCap:autonum="• " valign="top"><span class="_Override" style="font-weight: bold;">Node Object</span> — an object reference to an instance of an <a class="MCXref" href="IDLffXMLDOMNode.html#objects_ff_3755668711_1105014">IDLffXMLDOMNode</a> subclass. This parameter is required and is supplied by the tree walker on every call.</td>
            </tr>
        </table>
        <table class="AutoNumber_p_Bullet" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 16px;" />
            <col style="width: 24px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Bullet" valign="top"><span>• </span>
                </td>
                <td class="AutoNumber_p_Bullet" MadCap:autonum="• " valign="top"><span class="_Override" style="font-weight: bold;">USERDATA</span> — an optional keyword parameter set by the tree walker to a variable containing a copy of the data provided in the <a class="MCXref" href="#objects_ff_3755668711_1272762">FILTER_USERDATA</a> keyword. If <a class="MCXref" href="#objects_ff_3755668711_1272762">FILTER_USERDATA</a> is not specified, USERDATA is not passed by the walker.</td>
            </tr>
        </table>
        <p>The function must return one of three scalar integer values:</p>
        <table style="width: 499px;caption-side: bottom;mc-table-style: url('../../Resources/TableStyles/Table_Format.css');" class="TableStyle_Table_Format" cellspacing="0">
            <col width="120px" />
            <col width="379px" />
            <thead>
                <tr>
                    <td class="TableStyle_Table_Format_Head_0_0_RowSep_ColSep">
                        <p class="CellHeading">Value</p>
                    </td>
                    <td class="TableStyle_Table_Format_Head_0_0_RowSep_ColEnd">
                        <p class="CellHeading">Function</p>
                    </td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColSep">
                        <p class="CellCentered">1</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColEnd">
                        <p class="CellBody">ACCEPT: the tree walker visits this node</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColSep">
                        <p class="CellCentered">2</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColEnd">
                        <p class="CellBody">REJECT: the tree walker does not visit this node or its children</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_0_0_RowEnd_ColSep">
                        <p class="CellCentered">3</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowEnd_ColEnd">
                        <p class="CellBody">SKIP: the tree walker does not visit this node, but considers the node’s children for visiting</p>
                    </td>
                </tr>
            </tbody>
            <caption valign="bottom" style="padding-bottom: 12pt;">
                <p class="TableTitle"><a name="objects_ff_3755668711_69749"></a>Return Values for CreateTreeWalker’s Filter Function</p>
            </caption>
        </table>
        <p>If the function returns a value that is not supported, the tree walker visits the node, as if the return value were 1 (ACCEPT). If the function returns a value that cannot be converted to a scalar, IDL throws an error. </p>
        <p>The function should not destroy the node object passed as the first parameter.</p>
        <h3 class="Keyword"><a name="objects_ff_3755668711_1272762"></a><a name="objects_ff_3755668711_19803"></a>FILTER_USERDATA</h3>
        <p>Set this keyword to an IDL variable containing data to pass to the filter function each time the tree walker calls the filter function.</p>
        <p>Supplying this keyword without <a class="MCXref" href="#objects_ff_3755668711_1272710">FILTER_NAME</a> produces no effect on the tree walker.</p>
        <h3 class="Keyword"><a name="objects_ff_3755668711_1272769"></a><a name="objects_ff_3755668711_11362"></a>WHAT_TO_SHOW</h3>
        <p>Set this keyword to a scalar unsigned integer containing a bitmask, where each bit indicates types of nodes that the tree walker visits. If this keyword is not specified, the walker visits every node.</p>
        <table style="width: 480px;caption-side: bottom;mc-table-style: url('../../Resources/TableStyles/Table_Format.css');" class="TableStyle_Table_Format" cellspacing="0">
            <col width="192px" />
            <col width="144px" />
            <col width="144px" />
            <thead>
                <tr>
                    <td class="TableStyle_Table_Format_Head_0_0_RowSep_ColSep">
                        <p class="CellHeading">Type</p>
                    </td>
                    <td class="TableStyle_Table_Format_Head_0_0_RowSep_ColSep">
                        <p class="CellHeading">Value (Hex)</p>
                    </td>
                    <td class="TableStyle_Table_Format_Head_0_0_RowSep_ColEnd">
                        <p class="CellHeading">Value (Decimal)</p>
                    </td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColSep">
                        <p class="CellBody">ALL</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColSep">
                        <p class="CellCentered">‘ffff’xu</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColEnd">
                        <p class="CellCentered">65535U</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColSep">
                        <p class="CellBody">Element</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColSep">
                        <p class="CellCentered">‘0001’xu</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColEnd">
                        <p class="CellCentered">1U</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColSep">
                        <p class="CellBody">Attribute</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColSep">
                        <p class="CellCentered">‘0002’xu</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColEnd">
                        <p class="CellCentered">2U</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColSep">
                        <p class="CellBody">Text</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColSep">
                        <p class="CellCentered">‘0004’xu</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColEnd">
                        <p class="CellCentered">4U</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColSep">
                        <p class="CellBody">CDATA Section</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColSep">
                        <p class="CellCentered">‘0008’xu</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColEnd">
                        <p class="CellCentered">8U</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColSep">
                        <p class="CellBody">Entity Reference</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColSep">
                        <p class="CellCentered">‘0010’xu</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColEnd">
                        <p class="CellCentered">16U</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColSep">
                        <p class="CellBody">Entity</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColSep">
                        <p class="CellCentered">‘0020’xu</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColEnd">
                        <p class="CellCentered">32U</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColSep">
                        <p class="CellBody">Processing Instruction</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColSep">
                        <p class="CellCentered">‘0040’xu</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColEnd">
                        <p class="CellCentered">64U</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColSep">
                        <p class="CellBody">Comment</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColSep">
                        <p class="CellCentered">‘0080’xu</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColEnd">
                        <p class="CellCentered">128U</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColSep">
                        <p class="CellBody">Document</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColSep">
                        <p class="CellCentered">‘0100’xu</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColEnd">
                        <p class="CellCentered">256U</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColSep">
                        <p class="CellBody">Document Type</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColSep">
                        <p class="CellCentered">‘0200’xu</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowSep_ColEnd">
                        <p class="CellCentered">512U</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColSep">
                        <p class="CellBody">Document Fragment</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColSep">
                        <p class="CellCentered">‘0400’xu</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_1_0_RowSep_ColEnd">
                        <p class="CellCentered">1024U</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Table_Format_Body_0_0_RowEnd_ColSep">
                        <p class="CellBody">Notation</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowEnd_ColSep">
                        <p class="CellCentered">‘0800’xu</p>
                    </td>
                    <td class="TableStyle_Table_Format_Body_0_0_RowEnd_ColEnd">
                        <p class="CellCentered">2048U</p>
                    </td>
                </tr>
            </tbody>
            <caption valign="bottom" style="padding-bottom: 12pt;">
                <p class="TableTitle">Bitmasks for CreateTreeWalker’s WHAT_TO_SHOW Keyword</p>
            </caption>
        </table>
        <p>The tree walker performs the WHAT_TO_SHOW test for a node before calling any user-provided filter function.</p>
        <h2>Version History</h2>
        <p class="TableAnchor">&#160;</p>
        <table class="TableStyle_Version_Table" style="width: 499px;caption-side: top;mc-table-style: url('../../Resources/TableStyles/Version_Table.css');" cellspacing="0">
            <col width="91px" />
            <col width="408px" />
            <tbody>
                <tr>
                    <td class="TableStyle_Version_Table_Body_0_0_RowEnd_ColSep">
                        <p class="CellBody">6.2</p>
                    </td>
                    <td class="TableStyle_Version_Table_Body_0_0_RowEnd_ColEnd">
                        <p class="CellBody">Introduced</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js">
        </script>
    </body>
</html>