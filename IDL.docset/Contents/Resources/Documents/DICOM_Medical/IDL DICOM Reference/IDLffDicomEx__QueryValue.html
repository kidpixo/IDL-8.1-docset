<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="3" MadCap:lastHeight="72" MadCap:lastWidth="697" MadCap:disableMasterStylesheet="true" MadCap:tocPath="Additional Topics|Medical Imaging in IDL|IDL DICOM Reference|IDLffDicomEx" MadCap:medium="non-print" MadCap:InPreviewMode="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" MadCap:PathToHelpSystem="../../../" MadCap:HelpSystemFileName="idl.xml" MadCap:SearchType="Stem">
    <!-- saved from url=(0014)about:internet -->
    <head><title>IDLffDicomEx::QueryValue
        </title>
        <link href="../../SkinSupport/MadCap.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/Version_Table.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/IDL_style.css" rel="stylesheet" />
        <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink" style="display: none;"><a href="../../../idl_CSH.html#DICOM_Medical/IDL DICOM Reference/IDLffDicomEx__QueryValue.html" style="">Open topic with navigation</a>
        </p>
        <div class="MCBreadcrumbsBox"><a class="MCBreadcrumbsLink" href="../../OtherTopics.html">Additional Topics</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../Expanded DICOM Support in IDL/ExpandedDICOMFunctionality.html">Medical Imaging in IDL</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="DICOMEX_GETCONFIGFILEPAT.html">IDL DICOM Reference</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="IDLffDicomEx.html">IDLffDicomEx</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">IDLffDicomEx::QueryValue</span>
        </div>
        <h1 class="ObjMethod">IDLffDicomEx::QueryValue
        </h1>
        <p>The IDLffDicomEx::QueryValue function method checks a DICOM file for the presence of a specified attribute. This method allows you to verify the presence of a tag prior to calling a method that requires a DICOM attribute to be present and have a value in order to succeed. Attempting to call GetValue, GetValueCount, GetValueLength, GetVR, and GetProperty methods all return an error when you attempt to access an attribute that does not exist in a DICOM file. GetValue and GetProperty also fail when attempting to access an attribute that does not have a value.</p>
        <p>This method is especially useful for determining the number of frames in an image prior to attempting to use this value when accessing pixel data. The Number of Frames tag is typically only present in multi-frame image files so when writing code that handles both single frame and multi-frame images, QueryValue can be used to determine if the Number of Frames DICOM attribute is present in the file.</p>
        <p class="Tip" MadCap:autonum="&lt;b&gt;Tip: &lt;/b&gt;"><span class="autonumber"><span><b>Tip: </b></span></span>For IDLffDicomEx properties, you can query using a property name (e.g., <a href="IDLffDicomEx.html#dicom_ex_4010397576_1025697" class="MCXref">IDLffDicomEx</a>) instead of having to specify the DICOM attribute (e.g., 0028,0008). </p>
        <h2><a name="dicom_ex_4010397576_1008328"></a><a name="dicom_ex_4010397576_1008328_PageTOC_IDLffDicomEx"></a>Syntax</h2>
        <p class="Syntax"><span class="Italic">Result</span> = <span class="Italic">Obj</span>-&gt;[<a href="IDLffDicomEx.html" class="MCXref">IDLffDicomEx</a>::]QueryValue(<span class="Italic">DicomTag </span>[,&#160;<a href="#dicom_ex_4010397576_1008348" class="MCXref">SEQID</a>=<span class="Italic">integer</span>]&#160;) </p>
        <h2><a name="dicom_ex_4010397576_1008330"></a><a name="dicom_ex_4010397576_1008330_PageTOC_IDLffDicomEx"></a>Return Value</h2>
        <p>This method returns one of the following:</p>
        <table class="AutoNumber_p_Bullet" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 16px;" />
            <col style="width: 24px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Bullet" valign="top"><span>• </span>
                </td>
                <td class="AutoNumber_p_Bullet" MadCap:autonum="• " valign="top">0 = tag not found</td>
            </tr>
        </table>
        <table class="AutoNumber_p_Bullet" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 16px;" />
            <col style="width: 24px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Bullet" valign="top"><span>• </span>
                </td>
                <td class="AutoNumber_p_Bullet" MadCap:autonum="• " valign="top">1 = tag found but does not have a value</td>
            </tr>
        </table>
        <table class="AutoNumber_p_Bullet" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 16px;" />
            <col style="width: 24px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Bullet" valign="top"><span>• </span>
                </td>
                <td class="AutoNumber_p_Bullet" MadCap:autonum="• " valign="top">2 = tag found and has a value</td>
            </tr>
        </table>
        <p>A return value of 0 or 1 indicates attempting to call GetValue would cause an error. A return value of 2 means GetValue would succeed for the specified attribute.</p>
        <h2><a name="dicom_ex_4010397576_1008336"></a><a name="dicom_ex_4010397576_1008336_PageTOC_IDLffDicomEx"></a>Arguments</h2>
        <h3 class="Argument">DicomTag</h3>
        <p>A string that identifies either of the following:</p>
        <table class="AutoNumber_p_Bullet" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 16px;" />
            <col style="width: 24px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Bullet" valign="top"><span>• </span>
                </td>
                <td class="AutoNumber_p_Bullet" MadCap:autonum="• " valign="top">A group and element of a DICOM attribute in the form <span class="Courier">'XXXX,XXXX'</span>. The <span class="Italic">DicomTag</span> argument must reference a public tag. See <a href="../DICOM Resources/DICOMAttributes.html">DICOM Attributes</a> for a list of tags.</td>
            </tr>
        </table>
        <table class="AutoNumber_p_Bullet" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 16px;" />
            <col style="width: 24px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Bullet" valign="top"><span>• </span>
                </td>
                <td class="AutoNumber_p_Bullet" MadCap:autonum="• " valign="top">An IDLffDicomEx property name, such as BITS_ALLOCATED. Allowable property names are any of those listed in <a href="IDLffDicomEx.html#dicom_ex_4010397576_1025181" class="MCXref">IDLffDicomEx</a>.</td>
            </tr>
        </table>
        <p class="Note_Indented" MadCap:autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>When querying an IDLffDicomEx property name, the SEQID keyword is ignored. All named properties exist at the root level of the DICOM file, not within sequences.</p>
        <h2><a name="dicom_ex_4010397576_1008347"></a><a name="dicom_ex_4010397576_1008347_PageTOC_IDLffDicomEx"></a>Keywords</h2>
        <h3 class="Keyword"><a name="dicom_ex_4010397576_1008348"></a><a name="dicom_ex_4010397576_64656"></a>SEQID</h3>
        <p>Set this keyword only if retrieving the value of an attribute that exists within a sequence. Use this keyword to specify a sequence identifier as follows:</p>
        <table class="AutoNumber_p_Bullet" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 16px;" />
            <col style="width: 24px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Bullet" valign="top"><span>• </span>
                </td>
                <td class="AutoNumber_p_Bullet" MadCap:autonum="• " valign="top">Set to a non-zero value (a sequence identifier) indicating the sequence in which the value is contained. This sequence identifier may have been returned via a previous call to the GetValue method. </td>
            </tr>
        </table>
        <table class="AutoNumber_p_Bullet" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 16px;" />
            <col style="width: 24px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Bullet" valign="top"><span>• </span>
                </td>
                <td class="AutoNumber_p_Bullet" MadCap:autonum="• " valign="top">Set to 0 or do not specify this keyword to indicate the attribute exists at the root level of the DICOM file. This is the default. </td>
            </tr>
        </table>
        <h2><a name="dicom_ex_4010397576_1037580"></a><a name="dicom_ex_4010397576_1037580_PageTOC_IDLffDicomEx"></a>Example</h2>
        <p>The following code checks for the Number of Frames attribute (0028,0008) indicating the image contains multiple frames. Attempting to just return a value for this attribute may fail as not all image SOP Classes require this tag to be present for single-frame images. For a complete example, see the “Example” section of <a href="IDLffDicomEx__ChangeTransferSyntax.html#dicom_ex_4010397576_1123452" class="MCXref">IDLffDicomEx::ChangeTransferSyntax
        </a>. </p>
        <p class="Note" MadCap:autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>In an image containing multiple frames, the returned frames are indexed in a zero-based array; hence the Number of Frames (attribute or property) value minus one will return the desired frame when accessing pixel data.</p>
        <p class="Code">; Check to see if the image has multiple frames.</p>
        <p class="Code">frameTest = oImg-&gt;QueryValue('0028,0008')</p>
        <p class="Code">IF FrameTest EQ 2 THEN BEGIN</p>
        <p class="Code">&#160;&#160;&#160;oImg-&gt;GetProperty, NUMBER_OF_FRAMES=frames</p>
        <p class="Code">&#160;&#160;&#160;frames = frames - 1</p>
        <p class="Code">ENDIF ELSE BEGIN</p>
        <p class="Code">&#160;&#160;&#160;frames = 0</p>
        <p class="Code">ENDELSE</p>
        <h2><a name="dicom_ex_4010397576_1008352"></a><a name="dicom_ex_4010397576_1008352_PageTOC_IDLffDicomEx"></a>Version History</h2>
        <p class="TableAnchor">&#160;</p>
        <table class="TableStyle_Version_Table" style="width: 499px;caption-side: top;mc-table-style: url('../../Resources/TableStyles/Version_Table.css');" cellspacing="0">
            <col width="91px" />
            <col width="408px" />
            <tbody>
                <tr>
                    <td class="TableStyle_Version_Table_Body_0_0_RowEnd_ColSep">
                        <p class="CellBody">6.1</p>
                    </td>
                    <td class="TableStyle_Version_Table_Body_0_0_RowEnd_ColEnd">
                        <p class="CellBody">Introduced</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js">
        </script>
    </body>
</html>